"use strict";require("source-map-support/register");const{_}=require("@genx/july");const Feature=require("../enum/Feature");const{requireConfig}=require("../utils/Helpers");module.exports={type:Feature.CONF,load_:async(app,config)=>{requireConfig(app,config,["driver","connectionString","entity","key"],"configFromDataSource");const{Connector}=app.tryRequire("@genx/data");let connector=Connector.createConnector(config.driver,config.connectionString,{logger:app.logger||app.server.logger});try{let cfgData=await connector.findOne_(config.entity,config.key);if(cfgData){app.config=_.defaults(cfgData,app.config)}else{app.log("warn",`Feature "configFromDataSource" @ "${connector.getConnectionStringWithoutCredential()}" does not exist and this feature will be ignored.`)}}finally{await connector.end_()}}};
//# sourceMappingURL=configFromDataSource.js.map