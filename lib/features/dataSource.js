"use strict";require("source-map-support/register");const{_}=require("@genx/july");const Feature=require("../enum/Feature");const{InvalidConfiguration}=require("@genx/error");module.exports={type:Feature.SERVICE,load_:async(app,dataSources)=>{const{Connector}=app.tryRequire("@genx/data");const loggerProxy={log:(...args)=>app.log(...args)};_.forOwn(dataSources,(dataSource,dbms)=>{_.forOwn(dataSource,(config,connectorName)=>{let serviceName=dbms+"."+connectorName;if(!config.connection){throw new InvalidConfiguration(`Missing connection config for data source "${serviceName}".`,app,`dataSource.${dbms}.${connectorName}`)}let{connection:connectionString,...other}=config;let connectorService=Connector.createConnector(dbms,connectionString,{logger:loggerProxy,...other});app.registerService(serviceName,connectorService);app.on("stopping",elegantStoppers=>{elegantStoppers.push(connectorService.end_())})})})}};
//# sourceMappingURL=dataSource.js.map