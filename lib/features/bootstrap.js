"use strict";

require("source-map-support/register");

const path = require("path");

const Feature = require("../enum/Feature");

const Literal = require("../enum/Literal");

const {
  eachAsync_
} = require("@genx/july");

const {
  glob
} = require("@genx/sys");

module.exports = {
  type: Feature.PLUGIN,
  load_: async function (app, options) {
    let bootPath = options.path ? app.toAbsolutePath(options.path) : path.join(app.workingPath, Literal.DEFAULT_BOOTSTRAP_PATH);
    let bp = path.join(bootPath, "**", "*.js");
    let files = await glob(bp, {
      nodir: true
    });
    return eachAsync_(files, async file => {
      let bootstrap = require(file);

      return bootstrap(app);
    });
  }
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9mZWF0dXJlcy9ib290c3RyYXAuanMiXSwibmFtZXMiOlsicGF0aCIsInJlcXVpcmUiLCJGZWF0dXJlIiwiTGl0ZXJhbCIsImVhY2hBc3luY18iLCJnbG9iIiwibW9kdWxlIiwiZXhwb3J0cyIsInR5cGUiLCJQTFVHSU4iLCJsb2FkXyIsImFwcCIsIm9wdGlvbnMiLCJib290UGF0aCIsInRvQWJzb2x1dGVQYXRoIiwiam9pbiIsIndvcmtpbmdQYXRoIiwiREVGQVVMVF9CT09UU1RSQVBfUEFUSCIsImJwIiwiZmlsZXMiLCJub2RpciIsImZpbGUiLCJib290c3RyYXAiXSwibWFwcGluZ3MiOiJBQUFBOzs7O0FBT0EsTUFBTUEsSUFBSSxHQUFHQyxPQUFPLENBQUMsTUFBRCxDQUFwQjs7QUFDQSxNQUFNQyxPQUFPLEdBQUdELE9BQU8sQ0FBQyxpQkFBRCxDQUF2Qjs7QUFDQSxNQUFNRSxPQUFPLEdBQUdGLE9BQU8sQ0FBQyxpQkFBRCxDQUF2Qjs7QUFDQSxNQUFNO0FBQUVHLEVBQUFBO0FBQUYsSUFBaUJILE9BQU8sQ0FBQyxZQUFELENBQTlCOztBQUNBLE1BQU07QUFBRUksRUFBQUE7QUFBRixJQUFXSixPQUFPLENBQUMsV0FBRCxDQUF4Qjs7QUFFQUssTUFBTSxDQUFDQyxPQUFQLEdBQWlCO0FBS2JDLEVBQUFBLElBQUksRUFBRU4sT0FBTyxDQUFDTyxNQUxEO0FBY2JDLEVBQUFBLEtBQUssRUFBRSxnQkFBZ0JDLEdBQWhCLEVBQXFCQyxPQUFyQixFQUE4QjtBQUNqQyxRQUFJQyxRQUFRLEdBQUdELE9BQU8sQ0FBQ1osSUFBUixHQUNUVyxHQUFHLENBQUNHLGNBQUosQ0FBbUJGLE9BQU8sQ0FBQ1osSUFBM0IsQ0FEUyxHQUVUQSxJQUFJLENBQUNlLElBQUwsQ0FBVUosR0FBRyxDQUFDSyxXQUFkLEVBQTJCYixPQUFPLENBQUNjLHNCQUFuQyxDQUZOO0FBSUEsUUFBSUMsRUFBRSxHQUFHbEIsSUFBSSxDQUFDZSxJQUFMLENBQVVGLFFBQVYsRUFBb0IsSUFBcEIsRUFBMEIsTUFBMUIsQ0FBVDtBQUVBLFFBQUlNLEtBQUssR0FBRyxNQUFNZCxJQUFJLENBQUNhLEVBQUQsRUFBSztBQUFFRSxNQUFBQSxLQUFLLEVBQUU7QUFBVCxLQUFMLENBQXRCO0FBRUEsV0FBT2hCLFVBQVUsQ0FBQ2UsS0FBRCxFQUFRLE1BQU9FLElBQVAsSUFBZ0I7QUFDckMsVUFBSUMsU0FBUyxHQUFHckIsT0FBTyxDQUFDb0IsSUFBRCxDQUF2Qjs7QUFDQSxhQUFPQyxTQUFTLENBQUNYLEdBQUQsQ0FBaEI7QUFDSCxLQUhnQixDQUFqQjtBQUlIO0FBM0JZLENBQWpCIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qKlxuICogRW5hYmxlIGJvb3RzdHJhcCBzY3JpcHRzXG4gKiBAbW9kdWxlIEZlYXR1cmVfQm9vdHN0cmFwXG4gKi9cblxuY29uc3QgcGF0aCA9IHJlcXVpcmUoXCJwYXRoXCIpO1xuY29uc3QgRmVhdHVyZSA9IHJlcXVpcmUoXCIuLi9lbnVtL0ZlYXR1cmVcIik7XG5jb25zdCBMaXRlcmFsID0gcmVxdWlyZShcIi4uL2VudW0vTGl0ZXJhbFwiKTtcbmNvbnN0IHsgZWFjaEFzeW5jXyB9ID0gcmVxdWlyZShcIkBnZW54L2p1bHlcIik7XG5jb25zdCB7IGdsb2IgfSA9IHJlcXVpcmUoXCJAZ2VueC9zeXNcIik7XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICAgIC8qKlxuICAgICAqIFRoaXMgZmVhdHVyZSBpcyBsb2FkZWQgYXQgcGx1Z2luIHN0YWdlXG4gICAgICogQG1lbWJlciB7c3RyaW5nfVxuICAgICAqL1xuICAgIHR5cGU6IEZlYXR1cmUuUExVR0lOLFxuXG4gICAgLyoqXG4gICAgICogTG9hZCB0aGUgZmVhdHVyZVxuICAgICAqIEBwYXJhbSB7QXBwfSBhcHAgLSBUaGUgY2xpIGFwcCBtb2R1bGUgb2JqZWN0XG4gICAgICogQHBhcmFtIHtvYmplY3R9IG9wdGlvbnMgLSBPcHRpb25zIGZvciB0aGUgZmVhdHVyZVxuICAgICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBbb3B0aW9ucy5wYXRoPSdib290c3RyYXAnXSAtIFRoZSBwYXRoIG9mIHRoZSBib290c3RyYXAgc2NyaXB0c1xuICAgICAqIEByZXR1cm5zIHtQcm9taXNlLjwqPn1cbiAgICAgKi9cbiAgICBsb2FkXzogYXN5bmMgZnVuY3Rpb24gKGFwcCwgb3B0aW9ucykge1xuICAgICAgICBsZXQgYm9vdFBhdGggPSBvcHRpb25zLnBhdGhcbiAgICAgICAgICAgID8gYXBwLnRvQWJzb2x1dGVQYXRoKG9wdGlvbnMucGF0aClcbiAgICAgICAgICAgIDogcGF0aC5qb2luKGFwcC53b3JraW5nUGF0aCwgTGl0ZXJhbC5ERUZBVUxUX0JPT1RTVFJBUF9QQVRIKTtcblxuICAgICAgICBsZXQgYnAgPSBwYXRoLmpvaW4oYm9vdFBhdGgsIFwiKipcIiwgXCIqLmpzXCIpO1xuXG4gICAgICAgIGxldCBmaWxlcyA9IGF3YWl0IGdsb2IoYnAsIHsgbm9kaXI6IHRydWUgfSk7XG5cbiAgICAgICAgcmV0dXJuIGVhY2hBc3luY18oZmlsZXMsIGFzeW5jIChmaWxlKSA9PiB7XG4gICAgICAgICAgICBsZXQgYm9vdHN0cmFwID0gcmVxdWlyZShmaWxlKTtcbiAgICAgICAgICAgIHJldHVybiBib290c3RyYXAoYXBwKTtcbiAgICAgICAgfSk7XG4gICAgfSxcbn07XG4iXX0=