"use strict";

require("source-map-support/register");

const {
  sleep_
} = require('rk-utils');

const startWorker = require('./worker');

async function startLoopWorker(worker, options) {
  let {
    interval,
    ...workerOptions
  } = options;

  if (typeof interval === 'undefined') {
    interval = 1000;
  }

  return startWorker(async app => {
    while (true) {
      await worker(app);
      await sleep_(interval);
    }
  }, workerOptions);
}

module.exports = startLoopWorker;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9zdGFydGVycy9sb29wV29ya2VyLmpzIl0sIm5hbWVzIjpbInNsZWVwXyIsInJlcXVpcmUiLCJzdGFydFdvcmtlciIsInN0YXJ0TG9vcFdvcmtlciIsIndvcmtlciIsIm9wdGlvbnMiLCJpbnRlcnZhbCIsIndvcmtlck9wdGlvbnMiLCJhcHAiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOzs7O0FBQUEsTUFBTTtBQUFFQSxFQUFBQTtBQUFGLElBQWFDLE9BQU8sQ0FBQyxVQUFELENBQTFCOztBQUNBLE1BQU1DLFdBQVcsR0FBR0QsT0FBTyxDQUFDLFVBQUQsQ0FBM0I7O0FBUUEsZUFBZUUsZUFBZixDQUErQkMsTUFBL0IsRUFBdUNDLE9BQXZDLEVBQWdEO0FBQzVDLE1BQUk7QUFBRUMsSUFBQUEsUUFBRjtBQUFZLE9BQUdDO0FBQWYsTUFBaUNGLE9BQXJDOztBQUVBLE1BQUksT0FBT0MsUUFBUCxLQUFvQixXQUF4QixFQUFxQztBQUNqQ0EsSUFBQUEsUUFBUSxHQUFHLElBQVg7QUFDSDs7QUFFRCxTQUFPSixXQUFXLENBQUMsTUFBT00sR0FBUCxJQUFlO0FBQzlCLFdBQU8sSUFBUCxFQUFhO0FBQ1QsWUFBTUosTUFBTSxDQUFDSSxHQUFELENBQVo7QUFDQSxZQUFNUixNQUFNLENBQUNNLFFBQUQsQ0FBWjtBQUNIO0FBQ0osR0FMaUIsRUFLZkMsYUFMZSxDQUFsQjtBQU1IOztBQUVERSxNQUFNLENBQUNDLE9BQVAsR0FBaUJQLGVBQWpCIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgeyBzbGVlcF8gfSA9IHJlcXVpcmUoJ3JrLXV0aWxzJyk7XG5jb25zdCBzdGFydFdvcmtlciA9IHJlcXVpcmUoJy4vd29ya2VyJyk7XG5cbi8qKlxuICogXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSB3b3JrZXIgXG4gKiBAcGFyYW0ge29iamVjdH0gb3B0aW9ucyBcbiAqIEBwcm9wZXJ0eSB7aW50ZWdlcn0gW29wdGlvbnMuaW50ZXJ2YWw9MTAwMF1cbiAqL1xuYXN5bmMgZnVuY3Rpb24gc3RhcnRMb29wV29ya2VyKHdvcmtlciwgb3B0aW9ucykge1xuICAgIGxldCB7IGludGVydmFsLCAuLi53b3JrZXJPcHRpb25zIH0gPSBvcHRpb25zO1xuXG4gICAgaWYgKHR5cGVvZiBpbnRlcnZhbCA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgaW50ZXJ2YWwgPSAxMDAwO1xuICAgIH1cblxuICAgIHJldHVybiBzdGFydFdvcmtlcihhc3luYyAoYXBwKSA9PiB7ICAgICAgICAgICAgIFxuICAgICAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICAgICAgYXdhaXQgd29ya2VyKGFwcCk7XG4gICAgICAgICAgICBhd2FpdCBzbGVlcF8oaW50ZXJ2YWwpO1xuICAgICAgICB9ICAgICAgICAgICAgXG4gICAgfSwgd29ya2VyT3B0aW9ucyk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gc3RhcnRMb29wV29ya2VyOyJdfQ==