"use strict";

require("source-map-support/register");

const {
  sleep_
} = require('@genx/july');

const startWorker = require('./worker');

async function startLoopWorker(worker, options) {
  let {
    interval,
    ...workerOptions
  } = options;

  if (typeof interval === 'undefined') {
    interval = 1000;
  }

  return startWorker(async app => {
    while (true) {
      await worker(app);
      await sleep_(interval);
    }
  }, workerOptions);
}

module.exports = startLoopWorker;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9zdGFydGVycy9sb29wV29ya2VyLmpzIl0sIm5hbWVzIjpbInNsZWVwXyIsInJlcXVpcmUiLCJzdGFydFdvcmtlciIsInN0YXJ0TG9vcFdvcmtlciIsIndvcmtlciIsIm9wdGlvbnMiLCJpbnRlcnZhbCIsIndvcmtlck9wdGlvbnMiLCJhcHAiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOzs7O0FBQUEsTUFBTTtBQUFFQSxFQUFBQTtBQUFGLElBQWFDLE9BQU8sQ0FBQyxZQUFELENBQTFCOztBQUNBLE1BQU1DLFdBQVcsR0FBR0QsT0FBTyxDQUFDLFVBQUQsQ0FBM0I7O0FBUUEsZUFBZUUsZUFBZixDQUErQkMsTUFBL0IsRUFBdUNDLE9BQXZDLEVBQWdEO0FBQzVDLE1BQUk7QUFBRUMsSUFBQUEsUUFBRjtBQUFZLE9BQUdDO0FBQWYsTUFBaUNGLE9BQXJDOztBQUVBLE1BQUksT0FBT0MsUUFBUCxLQUFvQixXQUF4QixFQUFxQztBQUNqQ0EsSUFBQUEsUUFBUSxHQUFHLElBQVg7QUFDSDs7QUFFRCxTQUFPSixXQUFXLENBQUMsTUFBT00sR0FBUCxJQUFlO0FBQzlCLFdBQU8sSUFBUCxFQUFhO0FBQ1QsWUFBTUosTUFBTSxDQUFDSSxHQUFELENBQVo7QUFDQSxZQUFNUixNQUFNLENBQUNNLFFBQUQsQ0FBWjtBQUNIO0FBQ0osR0FMaUIsRUFLZkMsYUFMZSxDQUFsQjtBQU1IOztBQUVERSxNQUFNLENBQUNDLE9BQVAsR0FBaUJQLGVBQWpCIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgeyBzbGVlcF8gfSA9IHJlcXVpcmUoJ0BnZW54L2p1bHknKTtcbmNvbnN0IHN0YXJ0V29ya2VyID0gcmVxdWlyZSgnLi93b3JrZXInKTtcblxuLyoqXG4gKiBcbiAqIEBwYXJhbSB7RnVuY3Rpb259IHdvcmtlciBcbiAqIEBwYXJhbSB7b2JqZWN0fSBvcHRpb25zIFxuICogQHByb3BlcnR5IHtpbnRlZ2VyfSBbb3B0aW9ucy5pbnRlcnZhbD0xMDAwXVxuICovXG5hc3luYyBmdW5jdGlvbiBzdGFydExvb3BXb3JrZXIod29ya2VyLCBvcHRpb25zKSB7XG4gICAgbGV0IHsgaW50ZXJ2YWwsIC4uLndvcmtlck9wdGlvbnMgfSA9IG9wdGlvbnM7XG5cbiAgICBpZiAodHlwZW9mIGludGVydmFsID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICBpbnRlcnZhbCA9IDEwMDA7XG4gICAgfVxuXG4gICAgcmV0dXJuIHN0YXJ0V29ya2VyKGFzeW5jIChhcHApID0+IHsgICAgICAgICAgICAgXG4gICAgICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgICAgICBhd2FpdCB3b3JrZXIoYXBwKTtcbiAgICAgICAgICAgIGF3YWl0IHNsZWVwXyhpbnRlcnZhbCk7XG4gICAgICAgIH0gICAgICAgICAgICBcbiAgICB9LCB3b3JrZXJPcHRpb25zKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBzdGFydExvb3BXb3JrZXI7Il19