"use strict";

require("source-map-support/register");

function startCommand(commandName, commandHandler, config, loggerOpt) {
  const App = require('..');

  const {
    combine,
    colorize,
    simple
  } = App.loggerProvider.format;

  if (typeof loggerOpt === 'string') {
    loggerOpt = {
      level: loggerOpt
    };
  }

  loggerOpt = {
    colorize: true,
    level: 'info',
    ...loggerOpt
  };
  let cliApp = new App(commandName, {
    logger: {
      "transports": [{
        "type": "console",
        "options": {
          "level": loggerOpt.level,
          "format": loggerOpt.colorize ? combine(colorize(), simple()) : simple()
        }
      }]
    },
    loadConfigFromOptions: true,
    config
  });
  cliApp.start_().then(commandHandler).then(() => cliApp.stop_()).catch(error => {
    cliApp.logError(error);
    process.exit(1);
  });
}

module.exports = startCommand;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9hcHBzL2NvbW1hbmQuanMiXSwibmFtZXMiOlsic3RhcnRDb21tYW5kIiwiY29tbWFuZE5hbWUiLCJjb21tYW5kSGFuZGxlciIsImNvbmZpZyIsImxvZ2dlck9wdCIsIkFwcCIsInJlcXVpcmUiLCJjb21iaW5lIiwiY29sb3JpemUiLCJzaW1wbGUiLCJsb2dnZXJQcm92aWRlciIsImZvcm1hdCIsImxldmVsIiwiY2xpQXBwIiwibG9nZ2VyIiwibG9hZENvbmZpZ0Zyb21PcHRpb25zIiwic3RhcnRfIiwidGhlbiIsInN0b3BfIiwiY2F0Y2giLCJlcnJvciIsImxvZ0Vycm9yIiwicHJvY2VzcyIsImV4aXQiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOzs7O0FBQUEsU0FBU0EsWUFBVCxDQUFzQkMsV0FBdEIsRUFBbUNDLGNBQW5DLEVBQW1EQyxNQUFuRCxFQUEyREMsU0FBM0QsRUFBc0U7QUFDbEUsUUFBTUMsR0FBRyxHQUFHQyxPQUFPLENBQUMsSUFBRCxDQUFuQjs7QUFDQSxRQUFNO0FBQUVDLElBQUFBLE9BQUY7QUFBV0MsSUFBQUEsUUFBWDtBQUFxQkMsSUFBQUE7QUFBckIsTUFBZ0NKLEdBQUcsQ0FBQ0ssY0FBSixDQUFtQkMsTUFBekQ7O0FBRUEsTUFBSSxPQUFPUCxTQUFQLEtBQXFCLFFBQXpCLEVBQW1DO0FBQy9CQSxJQUFBQSxTQUFTLEdBQUc7QUFDUlEsTUFBQUEsS0FBSyxFQUFFUjtBQURDLEtBQVo7QUFHSDs7QUFFREEsRUFBQUEsU0FBUyxHQUFHO0FBQ1JJLElBQUFBLFFBQVEsRUFBRSxJQURGO0FBRVJJLElBQUFBLEtBQUssRUFBRSxNQUZDO0FBR1IsT0FBR1I7QUFISyxHQUFaO0FBTUEsTUFBSVMsTUFBTSxHQUFHLElBQUlSLEdBQUosQ0FBUUosV0FBUixFQUFxQjtBQUM5QmEsSUFBQUEsTUFBTSxFQUFFO0FBQ0osb0JBQWMsQ0FDVjtBQUNJLGdCQUFRLFNBRFo7QUFFSSxtQkFBVztBQUNQLG1CQUFTVixTQUFTLENBQUNRLEtBRFo7QUFFUCxvQkFBVVIsU0FBUyxDQUFDSSxRQUFWLEdBQXFCRCxPQUFPLENBQUNDLFFBQVEsRUFBVCxFQUFhQyxNQUFNLEVBQW5CLENBQTVCLEdBQXFEQSxNQUFNO0FBRjlEO0FBRmYsT0FEVTtBQURWLEtBRHNCO0FBWTlCTSxJQUFBQSxxQkFBcUIsRUFBRSxJQVpPO0FBYTlCWixJQUFBQTtBQWI4QixHQUFyQixDQUFiO0FBZ0JBVSxFQUFBQSxNQUFNLENBQUNHLE1BQVAsR0FBZ0JDLElBQWhCLENBQXFCZixjQUFyQixFQUFxQ2UsSUFBckMsQ0FBMEMsTUFBTUosTUFBTSxDQUFDSyxLQUFQLEVBQWhELEVBQWdFQyxLQUFoRSxDQUFzRUMsS0FBSyxJQUFJO0FBQzNFUCxJQUFBQSxNQUFNLENBQUNRLFFBQVAsQ0FBZ0JELEtBQWhCO0FBRUFFLElBQUFBLE9BQU8sQ0FBQ0MsSUFBUixDQUFhLENBQWI7QUFDSCxHQUpEO0FBS0g7O0FBRURDLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQnpCLFlBQWpCIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gc3RhcnRDb21tYW5kKGNvbW1hbmROYW1lLCBjb21tYW5kSGFuZGxlciwgY29uZmlnLCBsb2dnZXJPcHQpIHtcbiAgICBjb25zdCBBcHAgPSByZXF1aXJlKCcuLicpOyAgICBcbiAgICBjb25zdCB7IGNvbWJpbmUsIGNvbG9yaXplLCBzaW1wbGUgfSA9IEFwcC5sb2dnZXJQcm92aWRlci5mb3JtYXQ7XG5cbiAgICBpZiAodHlwZW9mIGxvZ2dlck9wdCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgbG9nZ2VyT3B0ID0ge1xuICAgICAgICAgICAgbGV2ZWw6IGxvZ2dlck9wdFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIGxvZ2dlck9wdCA9IHtcbiAgICAgICAgY29sb3JpemU6IHRydWUsXG4gICAgICAgIGxldmVsOiAnaW5mbycsXG4gICAgICAgIC4uLmxvZ2dlck9wdFxuICAgIH07XG5cbiAgICBsZXQgY2xpQXBwID0gbmV3IEFwcChjb21tYW5kTmFtZSwgeyBcbiAgICAgICAgbG9nZ2VyOiB7ICAgICAgICBcbiAgICAgICAgICAgIFwidHJhbnNwb3J0c1wiOiBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBcInR5cGVcIjogXCJjb25zb2xlXCIsXG4gICAgICAgICAgICAgICAgICAgIFwib3B0aW9uc1wiOiB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJsZXZlbFwiOiBsb2dnZXJPcHQubGV2ZWwsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImZvcm1hdFwiOiBsb2dnZXJPcHQuY29sb3JpemUgPyBjb21iaW5lKGNvbG9yaXplKCksIHNpbXBsZSgpKSA6IHNpbXBsZSgpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBdXG4gICAgICAgIH0sXG4gICAgICAgIGxvYWRDb25maWdGcm9tT3B0aW9uczogdHJ1ZSxcbiAgICAgICAgY29uZmlnXG4gICAgfSk7XG5cbiAgICBjbGlBcHAuc3RhcnRfKCkudGhlbihjb21tYW5kSGFuZGxlcikudGhlbigoKSA9PiBjbGlBcHAuc3RvcF8oKSkuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgICBjbGlBcHAubG9nRXJyb3IoZXJyb3IpO1xuXG4gICAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICB9KTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBzdGFydENvbW1hbmQ7Il19