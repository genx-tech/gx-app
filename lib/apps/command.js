"use strict";

require("source-map-support/register");

function startCommand(commandName, commandHandler, config, loggerOpt) {
  const App = require('..');

  const {
    combine,
    colorize,
    simple
  } = App.loggerProvider.format;

  if (typeof loggerOpt === 'string') {
    loggerOpt = {
      level: loggerOpt
    };
  }

  loggerOpt = {
    colorize: true,
    level: 'info',
    ...loggerOpt
  };
  let cliApp = new App(commandName, {
    logger: {
      "transports": [{
        "type": "console",
        "options": {
          "level": loggerOpt.level,
          "format": loggerOpt.colorize ? combine(colorize(), simple()) : simple()
        }
      }]
    },
    loadConfigFromOptions: true,
    config
  });
  cliApp.start_().then(commandHandler).then(() => cliApp.stop_()).catch(error => {
    if (cliApp.started) {}

    console.error(error);
    process.exit(1);
  });
}

module.exports = startCommand;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9hcHBzL2NvbW1hbmQuanMiXSwibmFtZXMiOlsic3RhcnRDb21tYW5kIiwiY29tbWFuZE5hbWUiLCJjb21tYW5kSGFuZGxlciIsImNvbmZpZyIsImxvZ2dlck9wdCIsIkFwcCIsInJlcXVpcmUiLCJjb21iaW5lIiwiY29sb3JpemUiLCJzaW1wbGUiLCJsb2dnZXJQcm92aWRlciIsImZvcm1hdCIsImxldmVsIiwiY2xpQXBwIiwibG9nZ2VyIiwibG9hZENvbmZpZ0Zyb21PcHRpb25zIiwic3RhcnRfIiwidGhlbiIsInN0b3BfIiwiY2F0Y2giLCJlcnJvciIsInN0YXJ0ZWQiLCJjb25zb2xlIiwicHJvY2VzcyIsImV4aXQiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOzs7O0FBQUEsU0FBU0EsWUFBVCxDQUFzQkMsV0FBdEIsRUFBbUNDLGNBQW5DLEVBQW1EQyxNQUFuRCxFQUEyREMsU0FBM0QsRUFBc0U7QUFDbEUsUUFBTUMsR0FBRyxHQUFHQyxPQUFPLENBQUMsSUFBRCxDQUFuQjs7QUFDQSxRQUFNO0FBQUVDLElBQUFBLE9BQUY7QUFBV0MsSUFBQUEsUUFBWDtBQUFxQkMsSUFBQUE7QUFBckIsTUFBZ0NKLEdBQUcsQ0FBQ0ssY0FBSixDQUFtQkMsTUFBekQ7O0FBRUEsTUFBSSxPQUFPUCxTQUFQLEtBQXFCLFFBQXpCLEVBQW1DO0FBQy9CQSxJQUFBQSxTQUFTLEdBQUc7QUFDUlEsTUFBQUEsS0FBSyxFQUFFUjtBQURDLEtBQVo7QUFHSDs7QUFFREEsRUFBQUEsU0FBUyxHQUFHO0FBQ1JJLElBQUFBLFFBQVEsRUFBRSxJQURGO0FBRVJJLElBQUFBLEtBQUssRUFBRSxNQUZDO0FBR1IsT0FBR1I7QUFISyxHQUFaO0FBTUEsTUFBSVMsTUFBTSxHQUFHLElBQUlSLEdBQUosQ0FBUUosV0FBUixFQUFxQjtBQUM5QmEsSUFBQUEsTUFBTSxFQUFFO0FBQ0osb0JBQWMsQ0FDVjtBQUNJLGdCQUFRLFNBRFo7QUFFSSxtQkFBVztBQUNQLG1CQUFTVixTQUFTLENBQUNRLEtBRFo7QUFFUCxvQkFBVVIsU0FBUyxDQUFDSSxRQUFWLEdBQXFCRCxPQUFPLENBQUNDLFFBQVEsRUFBVCxFQUFhQyxNQUFNLEVBQW5CLENBQTVCLEdBQXFEQSxNQUFNO0FBRjlEO0FBRmYsT0FEVTtBQURWLEtBRHNCO0FBWTlCTSxJQUFBQSxxQkFBcUIsRUFBRSxJQVpPO0FBYTlCWixJQUFBQTtBQWI4QixHQUFyQixDQUFiO0FBZ0JBVSxFQUFBQSxNQUFNLENBQUNHLE1BQVAsR0FBZ0JDLElBQWhCLENBQXFCZixjQUFyQixFQUFxQ2UsSUFBckMsQ0FBMEMsTUFBTUosTUFBTSxDQUFDSyxLQUFQLEVBQWhELEVBQWdFQyxLQUFoRSxDQUFzRUMsS0FBSyxJQUFJO0FBQzNFLFFBQUlQLE1BQU0sQ0FBQ1EsT0FBWCxFQUFvQixDQUVuQjs7QUFDQUMsSUFBQUEsT0FBTyxDQUFDRixLQUFSLENBQWNBLEtBQWQ7QUFDREcsSUFBQUEsT0FBTyxDQUFDQyxJQUFSLENBQWEsQ0FBYjtBQUNILEdBTkQ7QUFPSDs7QUFFREMsTUFBTSxDQUFDQyxPQUFQLEdBQWlCMUIsWUFBakIiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBzdGFydENvbW1hbmQoY29tbWFuZE5hbWUsIGNvbW1hbmRIYW5kbGVyLCBjb25maWcsIGxvZ2dlck9wdCkge1xuICAgIGNvbnN0IEFwcCA9IHJlcXVpcmUoJy4uJyk7ICAgIFxuICAgIGNvbnN0IHsgY29tYmluZSwgY29sb3JpemUsIHNpbXBsZSB9ID0gQXBwLmxvZ2dlclByb3ZpZGVyLmZvcm1hdDtcblxuICAgIGlmICh0eXBlb2YgbG9nZ2VyT3B0ID09PSAnc3RyaW5nJykge1xuICAgICAgICBsb2dnZXJPcHQgPSB7XG4gICAgICAgICAgICBsZXZlbDogbG9nZ2VyT3B0XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgbG9nZ2VyT3B0ID0ge1xuICAgICAgICBjb2xvcml6ZTogdHJ1ZSxcbiAgICAgICAgbGV2ZWw6ICdpbmZvJyxcbiAgICAgICAgLi4ubG9nZ2VyT3B0XG4gICAgfTtcblxuICAgIGxldCBjbGlBcHAgPSBuZXcgQXBwKGNvbW1hbmROYW1lLCB7IFxuICAgICAgICBsb2dnZXI6IHsgICAgICAgIFxuICAgICAgICAgICAgXCJ0cmFuc3BvcnRzXCI6IFtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIFwidHlwZVwiOiBcImNvbnNvbGVcIixcbiAgICAgICAgICAgICAgICAgICAgXCJvcHRpb25zXCI6IHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBcImxldmVsXCI6IGxvZ2dlck9wdC5sZXZlbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZm9ybWF0XCI6IGxvZ2dlck9wdC5jb2xvcml6ZSA/IGNvbWJpbmUoY29sb3JpemUoKSwgc2ltcGxlKCkpIDogc2ltcGxlKClcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF1cbiAgICAgICAgfSxcbiAgICAgICAgbG9hZENvbmZpZ0Zyb21PcHRpb25zOiB0cnVlLFxuICAgICAgICBjb25maWdcbiAgICB9KTtcblxuICAgIGNsaUFwcC5zdGFydF8oKS50aGVuKGNvbW1hbmRIYW5kbGVyKS50aGVuKCgpID0+IGNsaUFwcC5zdG9wXygpKS5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgIGlmIChjbGlBcHAuc3RhcnRlZCkge1xuICAgICAgICAgICAgXG4gICAgICAgIH1cbiAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgICAgICBwcm9jZXNzLmV4aXQoMSk7XG4gICAgfSk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gc3RhcnRDb21tYW5kOyJdfQ==